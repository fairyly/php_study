# docker study

- 安装Kitematic：https://docs.docker.com/kitematic/ 
- 最新的 Kitematic 发行版：https://github.com/docker/kitematic/releases
- Docker从入门到实战：https://yeasy.gitbooks.io/docker_practice/content/
<<<<<<< 9183e3f679bb25b10c2bee1d46b0febe2e3e5e15
- Docker从入门到实战版本库：[https://github.com/fairyly/docker_practice](https://github.com/fairyly/docker_practice)
- 网易云docker学习 ：http://docker.bingohuang.com/
=======
>>>>>>> Update docker.md

>>>

## docker-machine命令：

- #Windows和OSX需要
- $ docker-machine create --driver virtualbox default #创建docker主机
- $ docker-machine start default #启动docker主机
- $ eval "$(docker-machine env default)" #配置docker主机连接信息
- $ docker-machine ssh default #ssh连接到docker主机

---

## docker 命令

- 搜索镜像：https://hub.docker.com/
- $ docker pull node:4 #拉取镜像
- $ docker run -it --rm --name test_node -v "$PWD":/usr/src/app -w /usr/src/app node:4 node script.js 
  直接执行nodejs程序
- $ docker run -it --name study_node -v ~/work:/root -w /root node:4 bash  #创建容器


### 1. 查看docker信息（version、info）

* 查看docker版本 
```
  $docker version 
```
* 显示docker系统的信息  
```
  $docker info  
```

### 2. 对image的操作（search、pull、images、rmi、history）

```
# 检索image  
$docker search image_name  
  
# 下载image  
$docker pull image_name  
  
# 列出镜像列表; -a, --all=false Show all images; --no-trunc=false Don't truncate output; -q, --quiet=false Only show numeric IDs  
$docker images  
  
# 删除一个或者多个镜像; -f, --force=false Force; --no-prune=false Do not delete untagged parents  
$docker rmi image_name  
  
# 显示一个镜像的历史; --no-trunc=false Don't truncate output; -q, --quiet=false Only show numeric IDs  
$docker history image_name  
```

### 3. 启动容器（run）
  
```
# 在容器中运行"echo"命令，输出"hello word"  
$docker run image_name echo "hello word"  
  
# 交互式进入容器中  
$docker run -i -t image_name /bin/bash  
  
  
# 在容器中安装新的程序  
$docker run image_name apt-get install -y app_name  
```
### 4. 查看容器（ps）
```
# 列出当前所有正在运行的container  
$docker ps  
# 列出所有的container  
$docker ps -a  
# 列出最近一次启动的container  
$docker ps -l  

```
### 5. 保存对容器的修改（commit）

```
# 保存对容器的修改; -a, --author="" Author; -m, --message="" Commit message  
$docker commit ID new_image_name  

```
### 6. 对容器的操作（rm、stop、start、kill、logs、diff、top、cp、restart、attach）
```
# 删除所有容器  
$docker rm `docker ps -a -q`  
  
# 删除单个容器; -f, --force=false; -l, --link=false Remove the specified link and not the underlying container; -v, --volumes=false Remove the volumes associated to the container  
$docker rm Name/ID  
  
# 停止、启动、杀死一个容器  
$docker stop Name/ID  
$docker start Name/ID  
$docker kill Name/ID  
  
# 从一个容器中取日志; -f, --follow=false Follow log output; -t, --timestamps=false Show timestamps  
$docker logs Name/ID  
  
# 列出一个容器里面被改变的文件或者目录，list列表会显示出三种事件，A 增加的，D 删除的，C 被改变的  
$docker diff Name/ID  
  
# 显示一个运行的容器里面的进程信息  
$docker top Name/ID  
  
# 从容器里面拷贝文件/目录到本地一个路径  
$docker cp Name:/container_path to_path  
$docker cp ID:/container_path to_path  
  
# 重启一个正在运行的容器; -t, --time=10 Number of seconds to try to stop for before killing the container, Default=10  
$docker restart Name/ID  
  
# 附加到一个运行的容器上面; --no-stdin=false Do not attach stdin; --sig-proxy=true Proxify all received signal to the process  
$docker attach ID  

# 默认情况， docker-compose up 将会整合所有容器的输出，并且退出时，所有容器将会停止。

# 如果使用 docker-compose up -d ，将会在后台启动并运行所有的容器。

```
### 7. 保存和加载镜像（save、load）

```
# 保存镜像到一个tar包; -o, --output="" Write to an file  
$docker save image_name -o file_path  
# 加载一个tar包格式的镜像; -i, --input="" Read from a tar archive file  
$docker load -i file_path  
  
# 机器a  
$docker save image_name > /home/save.tar  
# 使用scp将save.tar拷到机器b上，然后：  
$docker load < /home/save.tar  

```
### 8、 登录registry server（login）

```
# 登陆registry server; -e, --email="" Email; -p, --password="" Password; -u, --username="" Username  
$docker login 

```
### 9. 发布image（push）

```
# 发布docker镜像  
$docker push new_image_name 

```
### 10.  根据Dockerfile 构建出一个容器

```
#build  
      --no-cache=false Do not use cache when building the image  
      -q, --quiet=false Suppress the verbose output generated by the containers  
      --rm=true Remove intermediate containers after a successful build  
      -t, --tag="" Repository name (and optionally a tag) to be applied to the resulting image in case of success  
$docker build -t image_name Dockerfile_path  
```

<<<<<<< 9183e3f679bb25b10c2bee1d46b0febe2e3e5e15
![](https://github.com/fairyly/php_study/tree/dev/docker_cmd.png)
=======

>>>>>>> Update docker.md

---
>>>

# Linux升级内核

如果内核版本过低，可以用下面的命令升级系统内核。

- Ubuntu 12.04 LTS  
1.sudo apt-get install -y --install-recommends linux-generic-lts-trusty  
- Ubuntu 14.04 LTS  
2.sudo apt-get install -y --install-recommends linux-generic-lts-xenial  

